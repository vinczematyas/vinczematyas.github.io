---
import GlobalHead from '@components/GlobalHead.astro';
import Header from '@components/Header.astro';
import Footer from '@components/Footer.astro';
import '@styles/global.css';
---

<html lang='en'>
  <head>
    <script is:inline>
      (() => {
        const root = document.documentElement;
        const mql = window.matchMedia ? window.matchMedia("(prefers-color-scheme: light)") : null;

        const applyTheme = (isLight) => {
          root.classList.toggle("theme-light", isLight);
          root.classList.toggle("theme-dark", !isLight);
          root.style.colorScheme = isLight ? "light" : "dark";
        };

        const setFromSystem = () => applyTheme(mql?.matches ?? false);
        setFromSystem();

        mql?.addEventListener?.("change", (event) => {
          // Always follow system; no stored overrides
          applyTheme(event.matches);
        });
      })();
    </script>
    <GlobalHead />
  </head>
  <body class='flex flex-col min-h-screen'>
    <Header />
    <main class='flex-grow'>
      <slot />
    </main>
    <Footer />
  </body>
</html>

